<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pl" xml:lang="pl">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Statystyka w języku Python</title>
  <meta name="description" content="Zbiór zastosowań języka Python w statystyce." />
  <meta name="generator" content="bookdown 0.10 and GitBook 2.6.7" />

  <meta property="og:title" content="Statystyka w języku Python" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Zbiór zastosowań języka Python w statystyce." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Statystyka w języku Python" />
  
  <meta name="twitter:description" content="Zbiór zastosowań języka Python w statystyce." />
  

<meta name="author" content="Krzysztof Trajkowski" />


<meta name="date" content="2019-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="R2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statystyka w języku Python </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Statystyki rozkładu</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#R11"><i class="fa fa-check"></i><b>1.1</b> Rozkład dyskretny</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#R12"><i class="fa fa-check"></i><b>1.2</b> Rozkład ciągły</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="R2.html"><a href="R2.html"><i class="fa fa-check"></i><b>2</b> Rozkład normalny</a><ul>
<li class="chapter" data-level="2.1" data-path="R2.html"><a href="R2.html#R21"><i class="fa fa-check"></i><b>2.1</b> Funkcja gęstości</a></li>
<li class="chapter" data-level="2.2" data-path="R2.html"><a href="R2.html#R22"><i class="fa fa-check"></i><b>2.2</b> Liniowy model regresji</a></li>
<li class="chapter" data-level="2.3" data-path="R2.html"><a href="R2.html#R23"><i class="fa fa-check"></i><b>2.3</b> Nieliniowy model regresji</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="R3.html"><a href="R3.html"><i class="fa fa-check"></i><b>3</b> Rozkład gamma</a><ul>
<li class="chapter" data-level="3.1" data-path="R3.html"><a href="R3.html#R31"><i class="fa fa-check"></i><b>3.1</b> Funkcja gęstości</a></li>
<li class="chapter" data-level="3.2" data-path="R3.html"><a href="R3.html#R32"><i class="fa fa-check"></i><b>3.2</b> Liniowy model gamma regresji</a></li>
<li class="chapter" data-level="3.3" data-path="R3.html"><a href="R3.html#R33"><i class="fa fa-check"></i><b>3.3</b> Nieliniowy model gamma regresji</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="R4.html"><a href="R4.html"><i class="fa fa-check"></i><b>4</b> Rozkład beta</a><ul>
<li class="chapter" data-level="4.1" data-path="R4.html"><a href="R4.html#R41"><i class="fa fa-check"></i><b>4.1</b> Funkcja gęstości</a></li>
<li class="chapter" data-level="4.2" data-path="R4.html"><a href="R4.html#R42"><i class="fa fa-check"></i><b>4.2</b> Liniowy model beta regresji</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="R5.html"><a href="R5.html"><i class="fa fa-check"></i><b>5</b> Rozkład beta dwumianowy</a><ul>
<li class="chapter" data-level="5.1" data-path="R5.html"><a href="R5.html#R51"><i class="fa fa-check"></i><b>5.1</b> Funkcja gęstości</a></li>
<li class="chapter" data-level="5.2" data-path="R5.html"><a href="R5.html#R52"><i class="fa fa-check"></i><b>5.2</b> Liniowy model beta dwumianowej regresji</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="R6.html"><a href="R6.html"><i class="fa fa-check"></i><b>6</b> Rozkład ujemny dwumianowy</a><ul>
<li class="chapter" data-level="6.1" data-path="R6.html"><a href="R6.html#R61"><i class="fa fa-check"></i><b>6.1</b> Funkcja gęstości</a></li>
<li class="chapter" data-level="6.2" data-path="R6.html"><a href="R6.html#R62"><i class="fa fa-check"></i><b>6.2</b> Liniowy model ujemnej dwumianowej regresji</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="R7.html"><a href="R7.html"><i class="fa fa-check"></i><b>7</b> Błąd standardowy estymatora</a><ul>
<li class="chapter" data-level="7.1" data-path="R7.html"><a href="R7.html#R71"><i class="fa fa-check"></i><b>7.1</b> Średnia</a></li>
<li class="chapter" data-level="7.2" data-path="R7.html"><a href="R7.html#R72"><i class="fa fa-check"></i><b>7.2</b> Proporcja</a></li>
<li class="chapter" data-level="7.3" data-path="R7.html"><a href="R7.html#R73"><i class="fa fa-check"></i><b>7.3</b> Mediana</a></li>
<li class="chapter" data-level="7.4" data-path="R7.html"><a href="R7.html#R74"><i class="fa fa-check"></i><b>7.4</b> Wariancja</a></li>
<li class="chapter" data-level="7.5" data-path="R7.html"><a href="R7.html#R75"><i class="fa fa-check"></i><b>7.5</b> Średnia ucięta</a></li>
<li class="chapter" data-level="7.6" data-path="R7.html"><a href="R7.html#R76"><i class="fa fa-check"></i><b>7.6</b> Skośność</a></li>
<li class="chapter" data-level="7.7" data-path="R7.html"><a href="R7.html#R77"><i class="fa fa-check"></i><b>7.7</b> Kurtoza</a></li>
<li class="chapter" data-level="7.8" data-path="R7.html"><a href="R7.html#R78"><i class="fa fa-check"></i><b>7.8</b> Bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="R8.html"><a href="R8.html"><i class="fa fa-check"></i><b>8</b> Porównanie zmiennych niezależnych</a><ul>
<li class="chapter" data-level="8.1" data-path="R8.html"><a href="R8.html#R81"><i class="fa fa-check"></i><b>8.1</b> Porównanie średnich</a></li>
<li class="chapter" data-level="8.2" data-path="R8.html"><a href="R8.html#R82"><i class="fa fa-check"></i><b>8.2</b> Porównanie rang</a></li>
<li class="chapter" data-level="8.3" data-path="R8.html"><a href="R8.html#R83"><i class="fa fa-check"></i><b>8.3</b> Porównanie wariancji</a></li>
<li class="chapter" data-level="8.4" data-path="R8.html"><a href="R8.html#R84"><i class="fa fa-check"></i><b>8.4</b> Porównanie rozkładów</a></li>
<li class="chapter" data-level="8.5" data-path="R8.html"><a href="R8.html#R85"><i class="fa fa-check"></i><b>8.5</b> Moc testu</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="R9.html"><a href="R9.html"><i class="fa fa-check"></i><b>9</b> Porównanie zmiennych zależnych</a><ul>
<li class="chapter" data-level="9.1" data-path="R9.html"><a href="R9.html#R91"><i class="fa fa-check"></i><b>9.1</b> Porównanie średnich</a></li>
<li class="chapter" data-level="9.2" data-path="R9.html"><a href="R9.html#R93"><i class="fa fa-check"></i><b>9.2</b> Porównanie rang</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliografia.html"><a href="bibliografia.html"><i class="fa fa-check"></i>Bibliografia</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statystyka w języku Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Statystyka w języku Python</h1>
<p class="author"><em>Krzysztof Trajkowski</em></p>
<p class="date"><em>2019-08-19</em></p>
</div>
<div id="R1" class="section level1">
<h1><span class="header-section-number">Rozdział 1</span> Statystyki rozkładu</h1>
<hr />
<div id="R11" class="section level2">
<h2><span class="header-section-number">1.1</span> Rozkład dyskretny</h2>
<p>Funkcja rozkładu prawdopodobieństwa <span class="math inline">\(f(x)\)</span> przedstawia dowolny rozkład dyskretny gdy:
<span class="math display" id="eq:prob01">\[\begin{equation}
0\leq f(x_i)\leq1\quad\textrm{oraz}\quad \sum_{i=1}^{n}f(x_i)=1\quad\textrm{dla}\quad i=1,2,3,\dots,n
\tag{1.1}
\end{equation}\]</span></p>
<p>Statystyki dla tego rodzaju rozkładów można obliczyć za pomocą wzorów:</p>
<p><span class="math display" id="eq:Kd" id="eq:Sd" id="eq:Vd" id="eq:Ed">\[\begin{align}
E(x)=\sum_{i=1}^{n}x_i\cdot f(x_i) \quad\longrightarrow\quad
&amp;
\textrm{średnia} \tag{1.2}\\[2.5pt]
V(x)=\sum_{i=1}^{n}f(x_i)\cdot \big[x_i-E(x)\big]^2 \quad\longrightarrow\quad
&amp;
\textrm{wariancja} \tag{1.3}\\[2.5pt]
SK(x)=\frac{1}{D(x)^3}\sum_{i=1}^{n}f(x_i)\cdot \big[x_i-E(x)\big]^3 \quad\longrightarrow\quad
&amp;
\textrm{skośność} \tag{1.4}\\[2.5pt]
KU(x)=\frac{1}{D(x)^4}\sum_{i=1}^{n}f(x_i)\cdot \big[x_i-E(x)\big]^4-3 \quad\longrightarrow\quad
&amp;
\textrm{kurtoza} \tag{1.5}
\end{align}\]</span></p>
<p>Przykładowo, dla rozkładu prawdopodobieństwa (rozkład Poissona) danego wzorem <span class="math inline">\(f(x)=\frac{\lambda^x\exp(-\lambda)}{x!}\)</span> gdzie <span class="math inline">\(x!=\Gamma(x+1)\)</span> można wyprowadzić następujące wzory: <span class="math inline">\(E(x)= \lambda\)</span>, <span class="math inline">\(V(x)=\lambda\)</span>, <span class="math inline">\(SK(x)=\lambda^{-1/2}\)</span>, <span class="math inline">\(KU(x)=\lambda^{-1}\)</span>.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> scipy.stats <span class="im">as</span> stats
<span class="im">import</span> pandas <span class="im">as</span> pd

mu, var, sk, ku <span class="op">=</span> stats.poisson.stats(mu<span class="op">=</span><span class="dv">3</span>,loc<span class="op">=</span><span class="dv">0</span>, moments<span class="op">=</span><span class="st">&#39;mvsk&#39;</span>)
df <span class="op">=</span> pd.DataFrame({<span class="st">&#39;średnia&#39;</span> :[mu], <span class="st">&#39;wariancja&#39;</span> :[var],<span class="op">\</span>
                   <span class="st">&#39;skośność&#39;</span>:[sk.<span class="bu">round</span>(<span class="dv">4</span>)], <span class="st">&#39;kurtoza&#39;</span>:[ku.<span class="bu">round</span>(<span class="dv">4</span>)]})
<span class="bu">print</span>(df)</code></pre>
<pre><code>##   średnia wariancja  skośność  kurtoza
## 0     3.0       3.0    0.5774   0.3333</code></pre>
</div>
<div id="R12" class="section level2">
<h2><span class="header-section-number">1.2</span> Rozkład ciągły</h2>
<p>Funkcja rozkładu prawdopodobieństwa <span class="math inline">\(f(x)\)</span> przedstawia dowolny rozkład ciągły gdy:
<span class="math display" id="eq:prob02">\[\begin{equation}
0\leq f(x_i)\leq1\quad\textrm{oraz}\quad \int_{-\infty}^{+\infty}f(x)\;dx=1
\tag{1.6}
\end{equation}\]</span></p>
<p>Statystyki dla tego rodzaju rozkładów można obliczyć za pomocą wzorów:</p>
<p><span class="math display" id="eq:Kc" id="eq:Sc" id="eq:Vc" id="eq:Ec">\[\begin{align}
E(x)=\int_{-\infty}^{\infty}x\cdot f(x)\; dx \quad\longrightarrow\quad
&amp;
\textrm{średnia} \tag{1.7}\\[2.5pt]
V(x)=\int_{-\infty}^{\infty} f(x)\cdot\big[x-E(x)\big]^2\; dx \quad\longrightarrow\quad
&amp;
\textrm{wariancja} \tag{1.8}\\[2.5pt]
SK(x)=\frac{1}{D(x)^3}\int_{-\infty}^{\infty} f(x)\cdot\big[x-E(x)\big]^3\; dx \quad\longrightarrow\quad
&amp;
\textrm{skośność} \tag{1.9}\\[2.5pt]
KU(x)=\frac{1}{D(x)^4}\int_{-\infty}^{\infty}  f(x)\cdot\big[x-E(x)\big]^4\; dx-3 \quad\longrightarrow\quad
&amp;
\textrm{kurtoza} \tag{1.10}
\end{align}\]</span></p>
<p>Warto zauważyć, że parametry danego rozkładu mogą odpowiadać pewnej kombinacji średniej i wariancj. W przypadku rozkładu gamma (patrz rozdział <a href="R3.html#R3">3</a>) będziemy mieli: <span class="math inline">\(E(x)=a\cdot s\)</span>, <span class="math inline">\(V(x)=a\cdot s^2\)</span>, <span class="math inline">\(SK(x)=\sqrt{4/a}\)</span>, <span class="math inline">\(KU(x)=6/a\)</span>. Wynika z tego, że <span class="math inline">\(a=E(x)^2/V(x)\)</span> oraz <span class="math inline">\(s=V(x)/E(x)\)</span> to odpowiednio parametr kształtu oraz skali.</p>
<pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> scipy.stats <span class="im">as</span> stats

v <span class="op">=</span> stats.gamma.rvs(a<span class="op">=</span><span class="fl">1.3</span>,loc<span class="op">=</span><span class="dv">0</span>,scale<span class="op">=</span><span class="fl">1.36</span>,size<span class="op">=</span><span class="dv">150</span>,random_state<span class="op">=</span><span class="dv">2305</span>)
fit <span class="op">=</span> stats.gamma.fit(v,floc<span class="op">=</span><span class="dv">0</span>)
mu,var,sk,ku <span class="op">=</span> stats.gamma.stats(a<span class="op">=</span>fit[<span class="dv">0</span>],loc<span class="op">=</span>fit[<span class="dv">1</span>],scale<span class="op">=</span>fit[<span class="dv">2</span>], moments<span class="op">=</span><span class="st">&#39;mvsk&#39;</span>)

<span class="bu">print</span>(<span class="st">&quot;MLE:</span><span class="ch">\n</span><span class="st">a= </span><span class="sc">%.4f</span><span class="st">, loc= </span><span class="sc">%.4f</span><span class="st">, s= </span><span class="sc">%.4f</span><span class="st">&quot;</span> <span class="op">%</span> (fit[<span class="dv">0</span>],fit[<span class="dv">1</span>],fit[<span class="dv">2</span>]))
<span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">średnia= </span><span class="sc">%.2f</span><span class="st">, wariancja= </span><span class="sc">%.2f</span><span class="st">, skośność= </span><span class="sc">%.2f</span><span class="st">, kurtoza= </span><span class="sc">%.2f</span><span class="st">&quot;</span> <span class="op">%</span> (mu,var,sk,ku))
<span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st">MOM:</span><span class="ch">\n</span><span class="st">średnia^2/wariancja: a= </span><span class="sc">%.2f</span><span class="st">, wariancja/średnia: s= </span><span class="sc">%.2f</span><span class="st">&quot;</span> <span class="op">%</span> (mu<span class="op">**</span><span class="dv">2</span><span class="op">/</span>var, var<span class="op">/</span>mu))</code></pre>
<pre><code>## MLE:
## a= 1.1907, loc= 0.0000, s= 1.3814
## 
## średnia= 1.64, wariancja= 2.27, skośność= 1.83, kurtoza= 5.04
## 
## MOM:
## średnia^2/wariancja: a= 1.19, wariancja/średnia: s= 1.38</code></pre>
<p>Ciekawym przypadkiem jest rozkład normalny (patrz rozdział <a href="R2.html#R2">2</a>) ponieważ średnia oraz odchylenie standardowe czyli pierwiastek kwadratowy z wariancji są jednocześnie parametrami tego rozkładu.
Dodajmy, że nie każdy rozkład prawdopodobieństwa musi mieć te statystyki określone.
Przykładem może być rozkład Cauchy’ego który nie ma zdefiniowanej średniej, wariancji, skośności oraz kurtozy.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="R2.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["PythonStat.pdf", "PythonStat.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
